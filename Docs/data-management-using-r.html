<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Data Management using R | Data Analyst Tutorial</title>
  <meta name="description" content="Chapter 2 Data Management using R | Data Analyst Tutorial" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Data Management using R | Data Analyst Tutorial" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Data Management using R | Data Analyst Tutorial" />
  
  
  

<meta name="author" content="Zehui Bai" />


<meta name="date" content="2023-09-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="data-management-using-sas.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data-Analyst-Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#lifecycle-of-data-analysis-project"><i class="fa fa-check"></i><b>1.1</b> Lifecycle of Data Analysis Project</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-content"><i class="fa fa-check"></i><b>1.2</b> Course Content</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-management-using-r.html"><a href="data-management-using-r.html"><i class="fa fa-check"></i><b>2</b> Data Management using R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-management-using-r.html"><a href="data-management-using-r.html#basis-system-seeting"><i class="fa fa-check"></i><b>2.1</b> Basis System Seeting</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-management-using-r.html"><a href="data-management-using-r.html#help-and-packages"><i class="fa fa-check"></i><b>2.1.1</b> Help and Packages</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-management-using-r.html"><a href="data-management-using-r.html#create-script"><i class="fa fa-check"></i><b>2.1.2</b> Create Script</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-management-using-r.html"><a href="data-management-using-r.html#basic-mathematische-operatoren-funktionen"><i class="fa fa-check"></i><b>2.1.3</b> Basic Mathematische Operatoren &amp; Funktionen</a></li>
<li class="chapter" data-level="2.1.4" data-path="data-management-using-r.html"><a href="data-management-using-r.html#data-type"><i class="fa fa-check"></i><b>2.1.4</b> Data Type</a></li>
<li class="chapter" data-level="2.1.5" data-path="data-management-using-r.html"><a href="data-management-using-r.html#objects-in-r"><i class="fa fa-check"></i><b>2.1.5</b> Objects in R</a></li>
<li class="chapter" data-level="2.1.6" data-path="data-management-using-r.html"><a href="data-management-using-r.html#function-in-r"><i class="fa fa-check"></i><b>2.1.6</b> Function in R</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-management-using-r.html"><a href="data-management-using-r.html#load-data"><i class="fa fa-check"></i><b>2.2</b> Load Data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-management-using-r.html"><a href="data-management-using-r.html#package-readr"><i class="fa fa-check"></i><b>2.2.1</b> Package readr</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-management-using-r.html"><a href="data-management-using-r.html#import-csv-data"><i class="fa fa-check"></i><b>2.2.2</b> Import csv data</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-management-using-r.html"><a href="data-management-using-r.html#import-txt-data"><i class="fa fa-check"></i><b>2.2.3</b> Import txt data</a></li>
<li class="chapter" data-level="2.2.4" data-path="data-management-using-r.html"><a href="data-management-using-r.html#import-excel-data"><i class="fa fa-check"></i><b>2.2.4</b> Import excel data</a></li>
<li class="chapter" data-level="2.2.5" data-path="data-management-using-r.html"><a href="data-management-using-r.html#import-stata-data"><i class="fa fa-check"></i><b>2.2.5</b> Import stata data</a></li>
<li class="chapter" data-level="2.2.6" data-path="data-management-using-r.html"><a href="data-management-using-r.html#import-sas-data"><i class="fa fa-check"></i><b>2.2.6</b> Import SAS data</a></li>
<li class="chapter" data-level="2.2.7" data-path="data-management-using-r.html"><a href="data-management-using-r.html#copy-from-clipboard"><i class="fa fa-check"></i><b>2.2.7</b> Copy from clipboard</a></li>
<li class="chapter" data-level="2.2.8" data-path="data-management-using-r.html"><a href="data-management-using-r.html#save-and-write-objective-in-r"><i class="fa fa-check"></i><b>2.2.8</b> Save and write objective in R</a></li>
<li class="chapter" data-level="2.2.9" data-path="data-management-using-r.html"><a href="data-management-using-r.html#save-the-plot"><i class="fa fa-check"></i><b>2.2.9</b> Save the plot</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-management-using-r.html"><a href="data-management-using-r.html#basic-data-management"><i class="fa fa-check"></i><b>2.3</b> Basic Data Management</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-management-using-r.html"><a href="data-management-using-r.html#apply-family"><i class="fa fa-check"></i><b>2.3.1</b> apply family</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-management-using-r.html"><a href="data-management-using-r.html#package-tidyr"><i class="fa fa-check"></i><b>2.4</b> Package tidyr</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-management-using-r.html"><a href="data-management-using-r.html#cheat-sheet"><i class="fa fa-check"></i><b>2.4.1</b> CHEAT SHEET</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-management-using-r.html"><a href="data-management-using-r.html#pivoting"><i class="fa fa-check"></i><b>2.4.2</b> Pivoting</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-management-using-r.html"><a href="data-management-using-r.html#gather-and-spread"><i class="fa fa-check"></i><b>2.4.3</b> gather and spread</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-management-using-r.html"><a href="data-management-using-r.html#separate-and-unite"><i class="fa fa-check"></i><b>2.4.4</b> separate and unite</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-management-using-r.html"><a href="data-management-using-r.html#package-dplyr"><i class="fa fa-check"></i><b>2.5</b> Package dplyr</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-management-using-r.html"><a href="data-management-using-r.html#cheat-sheet-1"><i class="fa fa-check"></i><b>2.5.1</b> CHEAT SHEET</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-management-using-r.html"><a href="data-management-using-r.html#across"><i class="fa fa-check"></i><b>2.5.2</b> across</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-management-using-r.html"><a href="data-management-using-r.html#arrange"><i class="fa fa-check"></i><b>2.5.3</b> arrange</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-management-using-r.html"><a href="data-management-using-r.html#coalesce"><i class="fa fa-check"></i><b>2.5.4</b> coalesce</a></li>
<li class="chapter" data-level="2.5.5" data-path="data-management-using-r.html"><a href="data-management-using-r.html#filter"><i class="fa fa-check"></i><b>2.5.5</b> filter</a></li>
<li class="chapter" data-level="2.5.6" data-path="data-management-using-r.html"><a href="data-management-using-r.html#if_else"><i class="fa fa-check"></i><b>2.5.6</b> if_else</a></li>
<li class="chapter" data-level="2.5.7" data-path="data-management-using-r.html"><a href="data-management-using-r.html#join"><i class="fa fa-check"></i><b>2.5.7</b> join</a></li>
<li class="chapter" data-level="2.5.8" data-path="data-management-using-r.html"><a href="data-management-using-r.html#mutate"><i class="fa fa-check"></i><b>2.5.8</b> mutate</a></li>
<li class="chapter" data-level="2.5.9" data-path="data-management-using-r.html"><a href="data-management-using-r.html#select"><i class="fa fa-check"></i><b>2.5.9</b> select</a></li>
<li class="chapter" data-level="2.5.10" data-path="data-management-using-r.html"><a href="data-management-using-r.html#summarise"><i class="fa fa-check"></i><b>2.5.10</b> summarise</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-management-using-r.html"><a href="data-management-using-r.html#package-stringr"><i class="fa fa-check"></i><b>2.6</b> Package stringr</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data-management-using-r.html"><a href="data-management-using-r.html#cheat-sheet-2"><i class="fa fa-check"></i><b>2.6.1</b> CHEAT SHEET</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-management-using-r.html"><a href="data-management-using-r.html#package-forcats"><i class="fa fa-check"></i><b>2.7</b> Package forcats</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="data-management-using-r.html"><a href="data-management-using-r.html#cheat-sheet-3"><i class="fa fa-check"></i><b>2.7.1</b> CHEAT SHEET</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="data-management-using-r.html"><a href="data-management-using-r.html#package-lubridate"><i class="fa fa-check"></i><b>2.8</b> Package lubridate</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="data-management-using-r.html"><a href="data-management-using-r.html#cheat-sheet-4"><i class="fa fa-check"></i><b>2.8.1</b> CHEAT SHEET</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html"><i class="fa fa-check"></i><b>3</b> Data Management using SAS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#input-data-into-sas"><i class="fa fa-check"></i><b>3.1</b> Input data into SAS</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#native-datasets-input"><i class="fa fa-check"></i><b>3.1.1</b> Native datasets input</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#reading-free-formatted-data-instream"><i class="fa fa-check"></i><b>3.1.2</b> Reading free formatted data instream</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#reading-fixed-formatted-data-instream"><i class="fa fa-check"></i><b>3.1.3</b> Reading fixed formatted data instream</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#infile-reading-fixed-formatted-data-from-an-external-file"><i class="fa fa-check"></i><b>3.1.4</b> INFILE: Reading fixed formatted data from an external file</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#write-the-sas-file"><i class="fa fa-check"></i><b>3.1.5</b> Write the SAS File</a></li>
<li class="chapter" data-level="3.1.6" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#import-csv-data-1"><i class="fa fa-check"></i><b>3.1.6</b> Import csv data</a></li>
<li class="chapter" data-level="3.1.7" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#import"><i class="fa fa-check"></i><b>3.1.7</b> %Import</a></li>
<li class="chapter" data-level="3.1.8" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#url"><i class="fa fa-check"></i><b>3.1.8</b> URL</a></li>
<li class="chapter" data-level="3.1.9" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#infile-read-multiple-raw-data-files"><i class="fa fa-check"></i><b>3.1.9</b> Infile Read multiple raw data files</a></li>
<li class="chapter" data-level="3.1.10" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#generate-automatic-file-name"><i class="fa fa-check"></i><b>3.1.10</b> Generate automatic file name</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#format-the-variables"><i class="fa fa-check"></i><b>3.2</b> Format the variables</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#proc-format"><i class="fa fa-check"></i><b>3.2.1</b> Proc format</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#copy-and-combine-sas-format-libraries"><i class="fa fa-check"></i><b>3.2.2</b> Copy and combine SAS format libraries</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#build-a-format-from-a-dataset"><i class="fa fa-check"></i><b>3.2.3</b> Build a format from a dataset</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#output-format-as-datasets"><i class="fa fa-check"></i><b>3.2.4</b> Output format as datasets</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#delete-the-format"><i class="fa fa-check"></i><b>3.2.5</b> Delete the format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#array"><i class="fa fa-check"></i><b>3.3</b> Array</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#defining"><i class="fa fa-check"></i><b>3.3.1</b> Defining</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#format-multiple-variables"><i class="fa fa-check"></i><b>3.3.2</b> Format multiple variables</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#arrays"><i class="fa fa-check"></i><b>3.3.3</b> 2*2 arrays</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#dynamic-element-list-using-macro-variables"><i class="fa fa-check"></i><b>3.3.4</b> Dynamic Element List using Macro Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#retain"><i class="fa fa-check"></i><b>3.4</b> Retain</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#generate-serial-number"><i class="fa fa-check"></i><b>3.4.1</b> Generate Serial Number</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#change-from-basilne"><i class="fa fa-check"></i><b>3.4.2</b> Change from Basilne</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#data-utilities"><i class="fa fa-check"></i><b>3.5</b> Data utilities</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#scan"><i class="fa fa-check"></i><b>3.5.1</b> %Scan</a></li>
<li class="chapter" data-level="3.5.2" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#eval-and-syseval"><i class="fa fa-check"></i><b>3.5.2</b> %eval and %syseval</a></li>
<li class="chapter" data-level="3.5.3" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#macro-variable-status"><i class="fa fa-check"></i><b>3.5.3</b> Macro variable status</a></li>
<li class="chapter" data-level="3.5.4" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#sysfunc"><i class="fa fa-check"></i><b>3.5.4</b> %SYSFUNC</a></li>
<li class="chapter" data-level="3.5.5" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#quoting-function"><i class="fa fa-check"></i><b>3.5.5</b> Quoting Function</a></li>
<li class="chapter" data-level="3.5.6" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#call-symput"><i class="fa fa-check"></i><b>3.5.6</b> Call Symput</a></li>
<li class="chapter" data-level="3.5.7" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#call-execute"><i class="fa fa-check"></i><b>3.5.7</b> Call Execute</a></li>
<li class="chapter" data-level="3.5.8" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#sysfunc-get-the-observations"><i class="fa fa-check"></i><b>3.5.8</b> %sysfunc get the observations</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#clean-up"><i class="fa fa-check"></i><b>3.6</b> Clean Up</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#basic-setting"><i class="fa fa-check"></i><b>3.6.1</b> Basic setting</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#delete-datasets"><i class="fa fa-check"></i><b>3.6.2</b> Delete datasets</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#deleting-formats"><i class="fa fa-check"></i><b>3.6.3</b> Deleting Formats</a></li>
<li class="chapter" data-level="3.6.4" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#remove-assigned-formats"><i class="fa fa-check"></i><b>3.6.4</b> Remove assigned formats</a></li>
<li class="chapter" data-level="3.6.5" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#delete-macro-variables"><i class="fa fa-check"></i><b>3.6.5</b> Delete macro variables</a></li>
<li class="chapter" data-level="3.6.6" data-path="data-management-using-sas.html"><a href="data-management-using-sas.html#delete-macro"><i class="fa fa-check"></i><b>3.6.6</b> Delete Macro</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://zehuibai.github.io/" target="blank">Author Profile</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analyst Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-management-using-r" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Data Management using R<a href="data-management-using-r.html#data-management-using-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="basis-system-seeting" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Basis System Seeting<a href="data-management-using-r.html#basis-system-seeting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="help-and-packages" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Help and Packages<a href="data-management-using-r.html#help-and-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Tools Global Options
<ul>
<li><code>getwd()</code></li>
<li><code>setwd("C:/.../")</code></li>
</ul></li>
<li>Source: <a href="http://r-project.org" class="uri">http://r-project.org</a></li>
<li>Install and load Packages
<ul>
<li><code>install.packages()</code></li>
<li><code>library()</code></li>
<li><code>library(help="pwr")</code></li>
<li>Releasing loaded packages: <code>detach(package:pwr)</code></li>
<li><code>remove.packages("pwr")</code></li>
<li>List all already installed packages: <code>library()</code></li>
</ul></li>
<li>Help system
<ul>
<li>Opens the (web) links to the manuals. <code>help.start()</code></li>
<li>Access help for specific functions
<ul>
<li><code>?sqrt</code></li>
<li><code>help(sqrt)</code></li>
<li><code>help("sqrt")</code></li>
</ul></li>
<li><code>apropos("mean")</code> returns a list of function names that contain the expression mean (<strong>functions displayed in the loaded packages.</strong>)</li>
<li><code>help(glm, try.all.packages=T)</code> searches in all installed packages and returns the names of these packages. The help page for a function in a package that has not yet been loaded can then be displayed using the package option.</li>
<li>Alternative <code>help(glm, package="stats")</code></li>
<li><code>help.search("truncated")</code> or <code>??truncated</code> searches for a specific word (here truncated) in the online help.</li>
<li><code>RSiteSearch("truncated")</code> searches help pages, vignettes and task views for the keyword “truncated”.</li>
</ul></li>
</ul>
</div>
<div id="create-script" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Create Script<a href="data-management-using-r.html#create-script" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Save a collection of R commands in a text file (R script) with the file extension “.R”.</li>
<li>R-Studio: File- New File - R Script</li>
<li>Comment
<ul>
<li><h3 id="in-r-script" class="hasAnchor">in R script<a href="data-management-using-r.html#in-r-script" class="anchor-section" aria-label="Anchor link to header"></a></h3></li>
<li><!--  -->
in R markdown</li>
</ul></li>
</ul>
</div>
<div id="basic-mathematische-operatoren-funktionen" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Basic Mathematische Operatoren &amp; Funktionen<a href="data-management-using-r.html#basic-mathematische-operatoren-funktionen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="02_Plots/02_Math_A.png" alt="Basic Mathematische Operatoren &amp; Funktionen A" width="100%" />
<p class="caption">
Figure 2.1: Basic Mathematische Operatoren &amp; Funktionen A
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="02_Plots/02_Math_B.png" alt="Basic Mathematische Operatoren &amp; Funktionen B" width="100%" />
<p class="caption">
Figure 2.2: Basic Mathematische Operatoren &amp; Funktionen B
</p>
</div>
<pre><code>5 !=2+2
TRUE &amp; FALSE
TRUE | FALSE
(4&gt;= 3|5==6) &amp; (4!=4)
FALSE || (2 !=3)
7%/%2
18%%3
Inf + Inf + 2
Inf - Inf + 2
5/0

x &lt;- 1:7
(x &gt; 2) &amp;&amp; (x &lt; 5)
(x &gt; 2) | (x &lt; 5)
(x &gt; 2) || (x &lt; 5)</code></pre>
</div>
<div id="data-type" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Data Type<a href="data-management-using-r.html#data-type" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>P93</p>
</div>
<div id="objects-in-r" class="section level3 hasAnchor" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> Objects in R<a href="data-management-using-r.html#objects-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vector: The <code>c()</code> function (for combine or concatenate) is used to define a vector. Examples:</p>
<pre><code>x &lt;- c(1,2,3,4); x
y &lt;- c(4,3,2,1); y
z &lt;- c(1:4); z
w &lt;- c(4:1); w
u &lt;- seq(1,4); u
a &lt;- c(&quot;Einführung&quot;,&quot;in R&quot;); a
seq(from=2,to=6,by=3)
seq(4,5,length=10)</code></pre>
<ul>
<li>Data.Frame</li>
<li>List:</li>
</ul>
</div>
<div id="function-in-r" class="section level3 hasAnchor" number="2.1.6">
<h3><span class="header-section-number">2.1.6</span> Function in R<a href="data-management-using-r.html#function-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>my.fun &lt;- function(x1 ,x2) (x1 + x2)/2 # order
my.fun &lt;- function(x1 ,x2){
(x1 + x2)/2
} # order
my.fun &lt;- function(x1 ,x2){
y &lt;- (x1 + x2)/2
y
}# order
my.fun &lt;- function(x1 ,x2){
y &lt;- (x1 + x2)/2
return(y)
}

# Calling the function:
my.fun(100, 200) # order
my.fun(x1 = 100, x2 = 200) # order
my.fun(x2 = 200, x1 = 100)</code></pre>
</div>
</div>
<div id="load-data" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Load Data<a href="data-management-using-r.html#load-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="package-readr" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Package readr<a href="data-management-using-r.html#package-readr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:readr-1"></span>
<img src="02_Plots/readr_sheet1.png" alt="Data Import: CHEAT SHEET" width="100%" />
<p class="caption">
Figure 2.3: Data Import: CHEAT SHEET
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:readr-2"></span>
<img src="02_Plots/readr_sheet2.png" alt="Data Import: CHEAT SHEET" width="100%" />
<p class="caption">
Figure 2.4: Data Import: CHEAT SHEET
</p>
</div>
</div>
<div id="import-csv-data" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Import csv data<a href="data-management-using-r.html#import-csv-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Scan function returns a <strong>list or vector</strong>. This makes the scanning function less useful for entering “rectangular” data</p>
<pre><code>mydata1 &lt;- read.csv(&quot;~/Desktop/SASUniversityEdition/myfolders/Daten/CRP.csv&quot;,
                    sep=&quot;;&quot;, 
                    header=TRUE)   
mydata2 &lt;- scan(&quot;~/Desktop/SASUniversityEdition/myfolders/Daten/CRP.csv&quot;, 
                sep=&quot;;&quot;, 
                what = list(&quot;integer&quot;,&quot;numeric&quot;))</code></pre>
</div>
<div id="import-txt-data" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Import txt data<a href="data-management-using-r.html#import-txt-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>test.semi &lt;- read.table(&quot;https://stats.idre.ucla.edu/wp-content/uploads/2016/02/testsemicolon.txt&quot;, header=T, sep=&quot;;&quot;)
print(test.semi)

pfad &lt;- &quot;~/Desktop/SASUniversityEdition/myfolders/Daten&quot;
mydata3 &lt;- read.table(file.path(pfad, &quot;CRP.csv&quot;), 
                      header=TRUE, sep=&quot;;&quot;, dec = &quot;,&quot;, skip=9) </code></pre>
</div>
<div id="import-excel-data" class="section level3 hasAnchor" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Import excel data<a href="data-management-using-r.html#import-excel-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>read.xlsx slow for large data sets (worksheet with more than 100 000 cells)<br />
</li>
<li>read.xlsx2 is faster on big files compared to read.xlsx function.</li>
</ul>
<pre><code>## install.packages(&quot;xlsx&quot;)
library(&quot;xlsx&quot;)
read.xlsx(file, sheetIndex, header=TRUE, colClasses=NA)
read.xlsx2(file, sheetIndex, header=TRUE, colClasses=&quot;character&quot;)</code></pre>
</div>
<div id="import-stata-data" class="section level3 hasAnchor" number="2.2.5">
<h3><span class="header-section-number">2.2.5</span> Import stata data<a href="data-management-using-r.html#import-stata-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>library(foreign)
test.stata &lt;- read.dta(&quot;https://stats.idre.ucla.edu/stat/data/test.dta&quot;)
print(test.stata)</code></pre>
</div>
<div id="import-sas-data" class="section level3 hasAnchor" number="2.2.6">
<h3><span class="header-section-number">2.2.6</span> Import SAS data<a href="data-management-using-r.html#import-sas-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>library(sas7bdat)
data &lt;- read.sas7bdat(&quot;~/Desktop/SASUniversityEdition/myfolders/Daten/uis.sas7bdat&quot;)
View(data)</code></pre>
</div>
<div id="copy-from-clipboard" class="section level3 hasAnchor" number="2.2.7">
<h3><span class="header-section-number">2.2.7</span> Copy from clipboard<a href="data-management-using-r.html#copy-from-clipboard" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>copdat &lt;- read.delim(&quot;clipboard&quot;)
yourdata &lt;- copdat </code></pre>
</div>
<div id="save-and-write-objective-in-r" class="section level3 hasAnchor" number="2.2.8">
<h3><span class="header-section-number">2.2.8</span> Save and write objective in R<a href="data-management-using-r.html#save-and-write-objective-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="save-as-r-datei" class="section level4 hasAnchor" number="2.2.8.1">
<h4><span class="header-section-number">2.2.8.1</span> Save as R-Datei<a href="data-management-using-r.html#save-as-r-datei" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<pre><code>path &lt;- &quot;C:/Users/zbai/Projects/00_Project/00 PMS_VENUS/VENUS_CIR/01_Datasets&quot;
saveRDS(save_objective, file = file.path(path, &quot;dataname.rds&quot; ))

save_objective &lt;- readRDS(file = file.path(path, &quot;dataname.rds&quot; ))</code></pre>
</div>
<div id="write.table-and-write.csv" class="section level4 hasAnchor" number="2.2.8.2">
<h4><span class="header-section-number">2.2.8.2</span> write.table and write.csv<a href="data-management-using-r.html#write.table-and-write.csv" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<pre><code>#  quote：字符串是否使用引号表示，默认为TRUE，也就是使用引号表示
#  row.names：是否导出行序号，默认为TRUE，也就是导出行序号 
#  col.names：是否导出列名，默认为TRUE，也就是导出列名 
#  sep：分隔符，默认为空格（” “），也就是以空格为分割列
write.table (data ,file =&quot;~/Desktop/f.csv&quot;, row.names = FALSE, col.names =FALSE, quote =FALSE)</code></pre>
</div>
<div id="write.foreign" class="section level4 hasAnchor" number="2.2.8.3">
<h4><span class="header-section-number">2.2.8.3</span> write.foreign<a href="data-management-using-r.html#write.foreign" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Save as SPSS- und SAS- Datei</p>
<pre><code>library(&quot;foreign&quot;)
datafile &lt;- tempfile()
codefile &lt;- tempfile()
write.foreign(esoph, datafile, codefile, package=&quot;SAS&quot;)
file.show(datafile)
file.show(codefile)
unlink(datafile)
unlink(codefile)</code></pre>
</div>
<div id="write.xlsx" class="section level4 hasAnchor" number="2.2.8.4">
<h4><span class="header-section-number">2.2.8.4</span> write.xlsx<a href="data-management-using-r.html#write.xlsx" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<pre><code># Write the first data set in a new workbook
write.xlsx(USArrests, file = &quot;./01_Datasets/myworkbook.xlsx&quot;,
      sheetName = &quot;USA-ARRESTS&quot;, append = FALSE)
# Add a second data set in a new worksheet
write.xlsx(mtcars, file = &quot;myworkbook.xlsx&quot;, 
           sheetName=&quot;MTCARS&quot;, append=TRUE)
# Add a third data set
write.xlsx(iris, file = &quot;myworkbook.xlsx&quot;,
           sheetName=&quot;IRIS&quot;, append=TRUE)</code></pre>
</div>
</div>
<div id="save-the-plot" class="section level3 hasAnchor" number="2.2.9">
<h3><span class="header-section-number">2.2.9</span> Save the plot<a href="data-management-using-r.html#save-the-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File formats for exporting plots:</p>
<ul>
<li>pdf(“rplot.pdf”): pdf file</li>
<li>png(“rplot.png”): png file</li>
<li>jpeg(“rplot.jpg”): jpeg file</li>
<li>postscript(“rplot.ps”): postscript file</li>
<li>bmp(“rplot.bmp”): bmp file</li>
<li>win.metafile(“rplot.wmf”): windows metafile</li>
</ul>
<pre><code># 1. Open a pdf file
pdf(&quot;rplot.pdf&quot;) 
# 2. Create a plot
plot(x = my_data$wt, y = my_data$mpg,
     pch = 16, frame = FALSE,
     xlab = &quot;wt&quot;, ylab = &quot;mpg&quot;, col = &quot;#2E9FDF&quot;)
# 3. Close the pdf file
dev.off() </code></pre>
</div>
</div>
<div id="basic-data-management" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Basic Data Management<a href="data-management-using-r.html#basic-data-management" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="apply-family" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> apply family<a href="data-management-using-r.html#apply-family" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="package-tidyr" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Package tidyr<a href="data-management-using-r.html#package-tidyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cheat-sheet" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> CHEAT SHEET<a href="data-management-using-r.html#cheat-sheet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tidyr-cheat-sheet-1"></span>
<img src="02_Plots/tidyr_sheet1.png" alt="Data Wrangling with dplyr and tidyr" width="100%" />
<p class="caption">
Figure 2.5: Data Wrangling with dplyr and tidyr
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tidyr-cheat-sheet-2"></span>
<img src="02_Plots/tidyr_sheet2.png" alt="Data Wrangling with dplyr and tidyr" width="100%" />
<p class="caption">
Figure 2.6: Data Wrangling with dplyr and tidyr
</p>
</div>
</div>
<div id="pivoting" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Pivoting<a href="data-management-using-r.html#pivoting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>One variable might be spread across multiple columns.</li>
<li>One observation might be scattered across multiple rows.
<ul>
<li><code>pivot_longer()</code></li>
<li><code>pivot_wider()</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-management-using-r.html#cb15-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyr&quot;</span>)</span>
<span id="cb15-2"><a href="data-management-using-r.html#cb15-2" tabindex="-1"></a>table4a</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   country     `1999` `2000`
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
## 1 Afghanistan    745   2666
## 2 Brazil       37737  80488
## 3 China       212258 213766</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data-management-using-r.html#cb17-1" tabindex="-1"></a>table4a <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="data-management-using-r.html#cb17-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">1999</span><span class="st">`</span>, <span class="st">`</span><span class="at">2000</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;cases&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   country     year   cases
##   &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
## 1 Afghanistan 1999     745
## 2 Afghanistan 2000    2666
## 3 Brazil      1999   37737
## 4 Brazil      2000   80488
## 5 China       1999  212258
## 6 China       2000  213766</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-management-using-r.html#cb19-1" tabindex="-1"></a>table2</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##    country      year type            count
##    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
##  1 Afghanistan  1999 cases             745
##  2 Afghanistan  1999 population   19987071
##  3 Afghanistan  2000 cases            2666
##  4 Afghanistan  2000 population   20595360
##  5 Brazil       1999 cases           37737
##  6 Brazil       1999 population  172006362
##  7 Brazil       2000 cases           80488
##  8 Brazil       2000 population  174504898
##  9 China        1999 cases          212258
## 10 China        1999 population 1272915272
## 11 China        2000 cases          213766
## 12 China        2000 population 1280428583</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data-management-using-r.html#cb21-1" tabindex="-1"></a>table2 <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="data-management-using-r.html#cb21-2" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> count)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data-management-using-r.html#cb23-1" tabindex="-1"></a><span class="do">## missing values</span></span>
<span id="cb23-2"><a href="data-management-using-r.html#cb23-2" tabindex="-1"></a><span class="do">## last observation carried forward</span></span>
<span id="cb23-3"><a href="data-management-using-r.html#cb23-3" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb23-4"><a href="data-management-using-r.html#cb23-4" tabindex="-1"></a>  <span class="sc">~</span> person,           <span class="sc">~</span> treatment, <span class="sc">~</span>response,</span>
<span id="cb23-5"><a href="data-management-using-r.html#cb23-5" tabindex="-1"></a>  <span class="st">&quot;Derrick Whitmore&quot;</span>, <span class="dv">1</span>,           <span class="dv">7</span>,</span>
<span id="cb23-6"><a href="data-management-using-r.html#cb23-6" tabindex="-1"></a>  <span class="cn">NA</span>,                 <span class="dv">2</span>,           <span class="dv">10</span>,</span>
<span id="cb23-7"><a href="data-management-using-r.html#cb23-7" tabindex="-1"></a>  <span class="cn">NA</span>,                 <span class="dv">3</span>,           <span class="dv">9</span>,</span>
<span id="cb23-8"><a href="data-management-using-r.html#cb23-8" tabindex="-1"></a>  <span class="st">&quot;Katherine Burke&quot;</span>,  <span class="dv">1</span>,           <span class="dv">4</span></span>
<span id="cb23-9"><a href="data-management-using-r.html#cb23-9" tabindex="-1"></a>)</span>
<span id="cb23-10"><a href="data-management-using-r.html#cb23-10" tabindex="-1"></a></span>
<span id="cb23-11"><a href="data-management-using-r.html#cb23-11" tabindex="-1"></a>treatment <span class="sc">%&gt;%</span> </span>
<span id="cb23-12"><a href="data-management-using-r.html#cb23-12" tabindex="-1"></a>  <span class="fu">fill</span>(person)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   person           treatment response
##   &lt;chr&gt;                &lt;dbl&gt;    &lt;dbl&gt;
## 1 Derrick Whitmore         1        7
## 2 Derrick Whitmore         2       10
## 3 Derrick Whitmore         3        9
## 4 Katherine Burke          1        4</code></pre>
</div>
<div id="gather-and-spread" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> gather and spread<a href="data-management-using-r.html#gather-and-spread" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data-management-using-r.html#cb25-1" tabindex="-1"></a><span class="do">## prepare data</span></span>
<span id="cb25-2"><a href="data-management-using-r.html#cb25-2" tabindex="-1"></a>olddata_wide <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">text=</span><span class="st">&#39;</span></span>
<span id="cb25-3"><a href="data-management-using-r.html#cb25-3" tabindex="-1"></a><span class="st"> subject sex control cond1 cond2</span></span>
<span id="cb25-4"><a href="data-management-using-r.html#cb25-4" tabindex="-1"></a><span class="st">       1   M     7.9  12.3  10.7</span></span>
<span id="cb25-5"><a href="data-management-using-r.html#cb25-5" tabindex="-1"></a><span class="st">       2   F     6.3  10.6  11.1</span></span>
<span id="cb25-6"><a href="data-management-using-r.html#cb25-6" tabindex="-1"></a><span class="st">       3   F     9.5  13.1  13.8</span></span>
<span id="cb25-7"><a href="data-management-using-r.html#cb25-7" tabindex="-1"></a><span class="st">       4   M    11.5  13.4  12.9</span></span>
<span id="cb25-8"><a href="data-management-using-r.html#cb25-8" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb25-9"><a href="data-management-using-r.html#cb25-9" tabindex="-1"></a>olddata_wide<span class="sc">$</span>subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(olddata_wide<span class="sc">$</span>subject)</span>
<span id="cb25-10"><a href="data-management-using-r.html#cb25-10" tabindex="-1"></a></span>
<span id="cb25-11"><a href="data-management-using-r.html#cb25-11" tabindex="-1"></a>olddata_long <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">text=</span><span class="st">&#39;</span></span>
<span id="cb25-12"><a href="data-management-using-r.html#cb25-12" tabindex="-1"></a><span class="st"> subject sex condition measurement</span></span>
<span id="cb25-13"><a href="data-management-using-r.html#cb25-13" tabindex="-1"></a><span class="st">       1   M   control         7.9</span></span>
<span id="cb25-14"><a href="data-management-using-r.html#cb25-14" tabindex="-1"></a><span class="st">       1   M     cond1        12.3</span></span>
<span id="cb25-15"><a href="data-management-using-r.html#cb25-15" tabindex="-1"></a><span class="st">       1   M     cond2        10.7</span></span>
<span id="cb25-16"><a href="data-management-using-r.html#cb25-16" tabindex="-1"></a><span class="st">       2   F   control         6.3</span></span>
<span id="cb25-17"><a href="data-management-using-r.html#cb25-17" tabindex="-1"></a><span class="st">       2   F     cond1        10.6</span></span>
<span id="cb25-18"><a href="data-management-using-r.html#cb25-18" tabindex="-1"></a><span class="st">       2   F     cond2        11.1</span></span>
<span id="cb25-19"><a href="data-management-using-r.html#cb25-19" tabindex="-1"></a><span class="st">       3   F   control         9.5</span></span>
<span id="cb25-20"><a href="data-management-using-r.html#cb25-20" tabindex="-1"></a><span class="st">       3   F     cond1        13.1</span></span>
<span id="cb25-21"><a href="data-management-using-r.html#cb25-21" tabindex="-1"></a><span class="st">       3   F     cond2        13.8</span></span>
<span id="cb25-22"><a href="data-management-using-r.html#cb25-22" tabindex="-1"></a><span class="st">       4   M   control        11.5</span></span>
<span id="cb25-23"><a href="data-management-using-r.html#cb25-23" tabindex="-1"></a><span class="st">       4   M     cond1        13.4</span></span>
<span id="cb25-24"><a href="data-management-using-r.html#cb25-24" tabindex="-1"></a><span class="st">       4   M     cond2        12.9</span></span>
<span id="cb25-25"><a href="data-management-using-r.html#cb25-25" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb25-26"><a href="data-management-using-r.html#cb25-26" tabindex="-1"></a>olddata_long<span class="sc">$</span>subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(olddata_long<span class="sc">$</span>subject)</span>
<span id="cb25-27"><a href="data-management-using-r.html#cb25-27" tabindex="-1"></a></span>
<span id="cb25-28"><a href="data-management-using-r.html#cb25-28" tabindex="-1"></a><span class="do">## factor_key将新键列视为一个因子（而不是字符向量）</span></span>
<span id="cb25-29"><a href="data-management-using-r.html#cb25-29" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(olddata_wide, condition, measurement, control<span class="sc">:</span>cond2, <span class="at">factor_key=</span><span class="cn">TRUE</span>)</span>
<span id="cb25-30"><a href="data-management-using-r.html#cb25-30" tabindex="-1"></a></span>
<span id="cb25-31"><a href="data-management-using-r.html#cb25-31" tabindex="-1"></a><span class="do">##########################################################</span></span>
<span id="cb25-32"><a href="data-management-using-r.html#cb25-32" tabindex="-1"></a><span class="co">#                     Äquivalent                         #</span></span>
<span id="cb25-33"><a href="data-management-using-r.html#cb25-33" tabindex="-1"></a>keycol <span class="ot">&lt;-</span> <span class="st">&quot;condition&quot;</span>                                    <span class="co">#</span></span>
<span id="cb25-34"><a href="data-management-using-r.html#cb25-34" tabindex="-1"></a>valuecol <span class="ot">&lt;-</span> <span class="st">&quot;measurement&quot;</span>                                <span class="co">#</span></span>
<span id="cb25-35"><a href="data-management-using-r.html#cb25-35" tabindex="-1"></a>gathercols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;cond1&quot;</span>, <span class="st">&quot;cond2&quot;</span>)             <span class="co">#</span></span>
<span id="cb25-36"><a href="data-management-using-r.html#cb25-36" tabindex="-1"></a><span class="fu">gather_</span>(olddata_wide, keycol, valuecol, gathercols)      <span class="co">#</span></span></code></pre></div>
<pre><code>##    subject sex condition measurement
## 1        1   M   control         7.9
## 2        2   F   control         6.3
## 3        3   F   control         9.5
## 4        4   M   control        11.5
## 5        1   M     cond1        12.3
## 6        2   F     cond1        10.6
## 7        3   F     cond1        13.1
## 8        4   M     cond1        13.4
## 9        1   M     cond2        10.7
## 10       2   F     cond2        11.1
## 11       3   F     cond2        13.8
## 12       4   M     cond2        12.9</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data-management-using-r.html#cb27-1" tabindex="-1"></a><span class="do">##########################################################</span></span>
<span id="cb27-2"><a href="data-management-using-r.html#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="data-management-using-r.html#cb27-3" tabindex="-1"></a>data_wide <span class="ot">&lt;-</span> <span class="fu">spread</span>(<span class="at">data=</span>olddata_long, <span class="at">key =</span> condition, <span class="at">value =</span> measurement, <span class="at">convert =</span> T)</span>
<span id="cb27-4"><a href="data-management-using-r.html#cb27-4" tabindex="-1"></a>data_wide <span class="sc">%&gt;%</span> str</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  5 variables:
##  $ subject: Factor w/ 4 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;: 1 2 3 4
##  $ sex    : chr  &quot;M&quot; &quot;F&quot; &quot;F&quot; &quot;M&quot;
##  $ cond1  : num  12.3 10.6 13.1 13.4
##  $ cond2  : num  10.7 11.1 13.8 12.9
##  $ control: num  7.9 6.3 9.5 11.5</code></pre>
</div>
<div id="separate-and-unite" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> separate and unite<a href="data-management-using-r.html#separate-and-unite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="data-management-using-r.html#cb29-1" tabindex="-1"></a>table3</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   country      year rate             
##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
## 1 Afghanistan  1999 745/19987071     
## 2 Afghanistan  2000 2666/20595360    
## 3 Brazil       1999 37737/172006362  
## 4 Brazil       2000 80488/174504898  
## 5 China        1999 212258/1272915272
## 6 China        2000 213766/1280428583</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data-management-using-r.html#cb31-1" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="data-management-using-r.html#cb31-2" tabindex="-1"></a>  <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   country      year cases  population
##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
## 1 Afghanistan  1999 745    19987071  
## 2 Afghanistan  2000 2666   20595360  
## 3 Brazil       1999 37737  172006362 
## 4 Brazil       2000 80488  174504898 
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="data-management-using-r.html#cb33-1" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="data-management-using-r.html#cb33-2" tabindex="-1"></a>  <span class="fu">separate</span>(year, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;century&quot;</span>, <span class="st">&quot;year&quot;</span>), <span class="at">sep =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   country     century year  rate             
##   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 19      99    745/19987071     
## 2 Afghanistan 20      00    2666/20595360    
## 3 Brazil      19      99    37737/172006362  
## 4 Brazil      20      00    80488/174504898  
## 5 China       19      99    212258/1272915272
## 6 China       20      00    213766/1280428583</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="data-management-using-r.html#cb35-1" tabindex="-1"></a>table5 <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="data-management-using-r.html#cb35-2" tabindex="-1"></a>  <span class="fu">unite</span>(new, century, year)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   country     new   rate             
##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 19_99 745/19987071     
## 2 Afghanistan 20_00 2666/20595360    
## 3 Brazil      19_99 37737/172006362  
## 4 Brazil      20_00 80488/174504898  
## 5 China       19_99 212258/1272915272
## 6 China       20_00 213766/1280428583</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data-management-using-r.html#cb37-1" tabindex="-1"></a>table5 <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="data-management-using-r.html#cb37-2" tabindex="-1"></a>  <span class="fu">unite</span>(new, century, year, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   country     new   rate             
##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 1999  745/19987071     
## 2 Afghanistan 2000  2666/20595360    
## 3 Brazil      1999  37737/172006362  
## 4 Brazil      2000  80488/174504898  
## 5 China       1999  212258/1272915272
## 6 China       2000  213766/1280428583</code></pre>
</div>
</div>
<div id="package-dplyr" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Package dplyr<a href="data-management-using-r.html#package-dplyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://cran.r-project.org/web/packages/dplyr/dplyr.pdf">Package ‘dplyr’</a></p>
<div id="cheat-sheet-1" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> CHEAT SHEET<a href="data-management-using-r.html#cheat-sheet-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dplyr-cheat-sheet-1"></span>
<img src="02_Plots/data_transformation1.png" alt="Data Transformation with dplyr" width="100%" />
<p class="caption">
Figure 2.7: Data Transformation with dplyr
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dplyr-cheat-sheet-2"></span>
<img src="02_Plots/data_transformation2.png" alt="Data Transformation with dplyr" width="100%" />
<p class="caption">
Figure 2.8: Data Transformation with dplyr
</p>
</div>
</div>
<div id="across" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> across<a href="data-management-using-r.html#across" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="data-management-using-r.html#cb39-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb39-2"><a href="data-management-using-r.html#cb39-2" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="data-management-using-r.html#cb39-3" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="data-management-using-r.html#cb39-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Sepal.Length, Sepal.Width), round))</span></code></pre></div>
<pre><code>## # A tibble: 150 × 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
##  1            5           4          1.4         0.2 setosa 
##  2            5           3          1.4         0.2 setosa 
##  3            5           3          1.3         0.2 setosa 
##  4            5           3          1.5         0.2 setosa 
##  5            5           4          1.4         0.2 setosa 
##  6            5           4          1.7         0.4 setosa 
##  7            5           3          1.4         0.3 setosa 
##  8            5           3          1.5         0.2 setosa 
##  9            4           3          1.4         0.2 setosa 
## 10            5           3          1.5         0.1 setosa 
## # ℹ 140 more rows</code></pre>
</div>
<div id="arrange" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> arrange<a href="data-management-using-r.html#arrange" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data-management-using-r.html#cb41-1" tabindex="-1"></a><span class="do">## Missing values are always sorted at the end:</span></span>
<span id="cb41-2"><a href="data-management-using-r.html#cb41-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;flights&quot;</span>,<span class="at">package=</span><span class="st">&quot;nycflights13&quot;</span>)</span>
<span id="cb41-3"><a href="data-management-using-r.html#cb41-3" tabindex="-1"></a><span class="fu">arrange</span>(flights, year, month, day)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 336,766 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="data-management-using-r.html#cb43-1" tabindex="-1"></a><span class="do">## in descending order:</span></span>
<span id="cb43-2"><a href="data-management-using-r.html#cb43-2" tabindex="-1"></a><span class="fu">arrange</span>(flights, <span class="fu">desc</span>(dep_delay))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     9      641            900      1301     1242           1530
##  2  2013     6    15     1432           1935      1137     1607           2120
##  3  2013     1    10     1121           1635      1126     1239           1810
##  4  2013     9    20     1139           1845      1014     1457           2210
##  5  2013     7    22      845           1600      1005     1044           1815
##  6  2013     4    10     1100           1900       960     1342           2211
##  7  2013     3    17     2321            810       911      135           1020
##  8  2013     6    27      959           1900       899     1236           2226
##  9  2013     7    22     2257            759       898      121           1026
## 10  2013    12     5      756           1700       896     1058           2020
## # ℹ 336,766 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="data-management-using-r.html#cb45-1" tabindex="-1"></a><span class="do">## group_by</span></span>
<span id="cb45-2"><a href="data-management-using-r.html#cb45-2" tabindex="-1"></a>by_cyl <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cyl)    </span>
<span id="cb45-3"><a href="data-management-using-r.html#cb45-3" tabindex="-1"></a><span class="do">## 无视之前的分组            </span></span>
<span id="cb45-4"><a href="data-management-using-r.html#cb45-4" tabindex="-1"></a>by_cyl <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(wt))    </span></code></pre></div>
<pre><code>## # A tibble: 32 × 11
## # Groups:   cyl [3]
##      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  10.4     8  460    215  3     5.42  17.8     0     0     3     4
##  2  14.7     8  440    230  3.23  5.34  17.4     0     0     3     4
##  3  10.4     8  472    205  2.93  5.25  18.0     0     0     3     4
##  4  16.4     8  276.   180  3.07  4.07  17.4     0     0     3     3
##  5  19.2     8  400    175  3.08  3.84  17.0     0     0     3     2
##  6  13.3     8  350    245  3.73  3.84  15.4     0     0     3     4
##  7  15.2     8  276.   180  3.07  3.78  18       0     0     3     3
##  8  17.3     8  276.   180  3.07  3.73  17.6     0     0     3     3
##  9  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
## 10  15       8  301    335  3.54  3.57  14.6     0     1     5     8
## # ℹ 22 more rows</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="data-management-using-r.html#cb47-1" tabindex="-1"></a><span class="do">## 在之前的分组内再排序    </span></span>
<span id="cb47-2"><a href="data-management-using-r.html#cb47-2" tabindex="-1"></a>by_cyl <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(wt), <span class="at">.by_group =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>## # A tibble: 32 × 11
## # Groups:   cyl [3]
##      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  24.4     4 147.     62  3.69  3.19  20       1     0     4     2
##  2  22.8     4 141.     95  3.92  3.15  22.9     1     0     4     2
##  3  21.4     4 121     109  4.11  2.78  18.6     1     1     4     2
##  4  21.5     4 120.     97  3.7   2.46  20.0     1     0     3     1
##  5  22.8     4 108      93  3.85  2.32  18.6     1     1     4     1
##  6  32.4     4  78.7    66  4.08  2.2   19.5     1     1     4     1
##  7  26       4 120.     91  4.43  2.14  16.7     0     1     5     2
##  8  27.3     4  79      66  4.08  1.94  18.9     1     1     4     1
##  9  33.9     4  71.1    65  4.22  1.84  19.9     1     1     4     1
## 10  30.4     4  75.7    52  4.93  1.62  18.5     1     1     4     2
## # ℹ 22 more rows</code></pre>
</div>
<div id="coalesce" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> coalesce<a href="data-management-using-r.html#coalesce" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="data-management-using-r.html#cb49-1" tabindex="-1"></a><span class="co"># Or match together a complete vector from missing pieces</span></span>
<span id="cb49-2"><a href="data-management-using-r.html#cb49-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">5</span>)</span>
<span id="cb49-3"><a href="data-management-using-r.html#cb49-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb49-4"><a href="data-management-using-r.html#cb49-4" tabindex="-1"></a><span class="fu">coalesce</span>(y, z)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="data-management-using-r.html#cb51-1" tabindex="-1"></a><span class="co"># Supply lists by with dynamic dots</span></span>
<span id="cb51-2"><a href="data-management-using-r.html#cb51-2" tabindex="-1"></a>vecs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb51-3"><a href="data-management-using-r.html#cb51-3" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">5</span>),</span>
<span id="cb51-4"><a href="data-management-using-r.html#cb51-4" tabindex="-1"></a>  <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb51-5"><a href="data-management-using-r.html#cb51-5" tabindex="-1"></a>)</span>
<span id="cb51-6"><a href="data-management-using-r.html#cb51-6" tabindex="-1"></a><span class="fu">coalesce</span>(<span class="sc">!!!</span>vecs)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
</div>
<div id="filter" class="section level3 hasAnchor" number="2.5.5">
<h3><span class="header-section-number">2.5.5</span> filter<a href="data-management-using-r.html#filter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="data-management-using-r.html#cb53-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;flights&quot;</span>,<span class="at">package=</span><span class="st">&quot;nycflights13&quot;</span>)</span>
<span id="cb53-2"><a href="data-management-using-r.html#cb53-2" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">1</span>, day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 842 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 832 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="data-management-using-r.html#cb55-1" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## # A tibble: 55,403 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013    11     1        5           2359         6      352            345
##  2  2013    11     1       35           2250       105      123           2356
##  3  2013    11     1      455            500        -5      641            651
##  4  2013    11     1      539            545        -6      856            827
##  5  2013    11     1      542            545        -3      831            855
##  6  2013    11     1      549            600       -11      912            923
##  7  2013    11     1      550            600       -10      705            659
##  8  2013    11     1      554            600        -6      659            701
##  9  2013    11     1      554            600        -6      826            827
## 10  2013    11     1      554            600        -6      749            751
## # ℹ 55,393 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="data-management-using-r.html#cb57-1" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">12</span>))    </span></code></pre></div>
<pre><code>## # A tibble: 55,403 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013    11     1        5           2359         6      352            345
##  2  2013    11     1       35           2250       105      123           2356
##  3  2013    11     1      455            500        -5      641            651
##  4  2013    11     1      539            545        -6      856            827
##  5  2013    11     1      542            545        -3      831            855
##  6  2013    11     1      549            600       -11      912            923
##  7  2013    11     1      550            600       -10      705            659
##  8  2013    11     1      554            600        -6      659            701
##  9  2013    11     1      554            600        -6      826            827
## 10  2013    11     1      554            600        -6      749            751
## # ℹ 55,393 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data-management-using-r.html#cb59-1" tabindex="-1"></a><span class="do">## Missing values,use is.na(x)</span></span>
<span id="cb59-2"><a href="data-management-using-r.html#cb59-2" tabindex="-1"></a>df <span class="ot">&lt;-</span>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">3</span>))</span>
<span id="cb59-3"><a href="data-management-using-r.html#cb59-3" tabindex="-1"></a><span class="fu">filter</span>(df, <span class="fu">is.na</span>(x) <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">1</span>) </span></code></pre></div>
<pre><code>## # A tibble: 2 × 1
##       x
##   &lt;dbl&gt;
## 1    NA
## 2     3</code></pre>
</div>
<div id="if_else" class="section level3 hasAnchor" number="2.5.6">
<h3><span class="header-section-number">2.5.6</span> if_else<a href="data-management-using-r.html#if_else" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="data-management-using-r.html#cb61-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb61-2"><a href="data-management-using-r.html#cb61-2" tabindex="-1"></a><span class="fu">ifelse</span>(x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), x, <span class="fu">factor</span>(<span class="cn">NA</span>))</span></code></pre></div>
<pre><code>##  [1]  1  2 NA NA  2 NA  2  2  3 NA</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="data-management-using-r.html#cb63-1" tabindex="-1"></a><span class="do">## 与ifelse不同，if_else保留类型</span></span>
<span id="cb63-2"><a href="data-management-using-r.html#cb63-2" tabindex="-1"></a><span class="fu">if_else</span>(x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), x, <span class="fu">factor</span>(<span class="cn">NA</span>))</span></code></pre></div>
<pre><code>##  [1] a    b    &lt;NA&gt; &lt;NA&gt; b    &lt;NA&gt; b    b    c    &lt;NA&gt;
## Levels: a b c d e</code></pre>
</div>
<div id="join" class="section level3 hasAnchor" number="2.5.7">
<h3><span class="header-section-number">2.5.7</span> join<a href="data-management-using-r.html#join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="data-management-using-r.html#cb65-1" tabindex="-1"></a><span class="do">## left join: 共有</span></span>
<span id="cb65-2"><a href="data-management-using-r.html#cb65-2" tabindex="-1"></a><span class="do">## full join: 全部</span></span>
<span id="cb65-3"><a href="data-management-using-r.html#cb65-3" tabindex="-1"></a><span class="do">## left join: 以左边为主</span></span>
<span id="cb65-4"><a href="data-management-using-r.html#cb65-4" tabindex="-1"></a></span>
<span id="cb65-5"><a href="data-management-using-r.html#cb65-5" tabindex="-1"></a><span class="do">## 选取变量 left join</span></span>
<span id="cb65-6"><a href="data-management-using-r.html#cb65-6" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;flights&quot;</span>,<span class="at">package=</span><span class="st">&quot;nycflights13&quot;</span>)</span>
<span id="cb65-7"><a href="data-management-using-r.html#cb65-7" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;airlines&quot;</span>,<span class="at">package=</span><span class="st">&quot;nycflights13&quot;</span>)</span>
<span id="cb65-8"><a href="data-management-using-r.html#cb65-8" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;weather&quot;</span>,<span class="at">package=</span><span class="st">&quot;nycflights13&quot;</span>)</span>
<span id="cb65-9"><a href="data-management-using-r.html#cb65-9" tabindex="-1"></a></span>
<span id="cb65-10"><a href="data-management-using-r.html#cb65-10" tabindex="-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb65-11"><a href="data-management-using-r.html#cb65-11" tabindex="-1"></a>  <span class="fu">select</span>(year<span class="sc">:</span>day, hour, origin, dest, tailnum, carrier)</span>
<span id="cb65-12"><a href="data-management-using-r.html#cb65-12" tabindex="-1"></a><span class="fu">head</span>(flights2)  </span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##    year month   day  hour origin dest  tailnum carrier
##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  
## 1  2013     1     1     5 EWR    IAH   N14228  UA     
## 2  2013     1     1     5 LGA    IAH   N24211  UA     
## 3  2013     1     1     5 JFK    MIA   N619AA  AA     
## 4  2013     1     1     5 JFK    BQN   N804JB  B6     
## 5  2013     1     1     6 LGA    ATL   N668DN  DL     
## 6  2013     1     1     5 EWR    ORD   N39463  UA</code></pre>
</div>
<div id="mutate" class="section level3 hasAnchor" number="2.5.8">
<h3><span class="header-section-number">2.5.8</span> mutate<a href="data-management-using-r.html#mutate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="data-management-using-r.html#cb67-1" tabindex="-1"></a><span class="do">## mutate()</span></span>
<span id="cb67-2"><a href="data-management-using-r.html#cb67-2" tabindex="-1"></a>flights_sml <span class="ot">&lt;-</span> <span class="fu">select</span>(flights, </span>
<span id="cb67-3"><a href="data-management-using-r.html#cb67-3" tabindex="-1"></a>  year<span class="sc">:</span>day, </span>
<span id="cb67-4"><a href="data-management-using-r.html#cb67-4" tabindex="-1"></a>  <span class="fu">ends_with</span>(<span class="st">&quot;delay&quot;</span>), </span>
<span id="cb67-5"><a href="data-management-using-r.html#cb67-5" tabindex="-1"></a>  distance, </span>
<span id="cb67-6"><a href="data-management-using-r.html#cb67-6" tabindex="-1"></a>  air_time</span>
<span id="cb67-7"><a href="data-management-using-r.html#cb67-7" tabindex="-1"></a>) </span></code></pre></div>
</div>
<div id="select" class="section level3 hasAnchor" number="2.5.9">
<h3><span class="header-section-number">2.5.9</span> select<a href="data-management-using-r.html#select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="data-management-using-r.html#cb68-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;flights&quot;</span>,<span class="at">package=</span><span class="st">&quot;nycflights13&quot;</span>)</span>
<span id="cb68-2"><a href="data-management-using-r.html#cb68-2" tabindex="-1"></a><span class="fu">select</span>(flights, year, month, day)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 3
##     year month   day
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1  2013     1     1
##  2  2013     1     1
##  3  2013     1     1
##  4  2013     1     1
##  5  2013     1     1
##  6  2013     1     1
##  7  2013     1     1
##  8  2013     1     1
##  9  2013     1     1
## 10  2013     1     1
## # ℹ 336,766 more rows</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="data-management-using-r.html#cb70-1" tabindex="-1"></a><span class="fu">select</span>(flights, year<span class="sc">:</span>day)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 3
##     year month   day
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1  2013     1     1
##  2  2013     1     1
##  3  2013     1     1
##  4  2013     1     1
##  5  2013     1     1
##  6  2013     1     1
##  7  2013     1     1
##  8  2013     1     1
##  9  2013     1     1
## 10  2013     1     1
## # ℹ 336,766 more rows</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="data-management-using-r.html#cb72-1" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="sc">-</span>(year<span class="sc">:</span>day))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 16
##    dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier
##       &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1      517            515         2      830            819        11 UA     
##  2      533            529         4      850            830        20 UA     
##  3      542            540         2      923            850        33 AA     
##  4      544            545        -1     1004           1022       -18 B6     
##  5      554            600        -6      812            837       -25 DL     
##  6      554            558        -4      740            728        12 UA     
##  7      555            600        -5      913            854        19 B6     
##  8      557            600        -3      709            723       -14 EV     
##  9      557            600        -3      838            846        -8 B6     
## 10      558            600        -2      753            745         8 AA     
## # ℹ 336,766 more rows
## # ℹ 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="data-management-using-r.html#cb74-1" tabindex="-1"></a>    <span class="do">## 辅助函数 helper functions can use within select():</span></span>
<span id="cb74-2"><a href="data-management-using-r.html#cb74-2" tabindex="-1"></a>       <span class="do">## starts_with(&quot;abc&quot;): matches names that begin with “abc”.</span></span>
<span id="cb74-3"><a href="data-management-using-r.html#cb74-3" tabindex="-1"></a>       <span class="do">## ends_with(&quot;xyz&quot;): matches names that end with “xyz”.</span></span>
<span id="cb74-4"><a href="data-management-using-r.html#cb74-4" tabindex="-1"></a>       <span class="do">## contains(&quot;ijk&quot;): matches names that contain “ijk”.</span></span>
<span id="cb74-5"><a href="data-management-using-r.html#cb74-5" tabindex="-1"></a>       <span class="do">## num_range(&quot;x&quot;, 1:3): matches x1, x2 and x3.</span></span>
<span id="cb74-6"><a href="data-management-using-r.html#cb74-6" tabindex="-1"></a>    <span class="do">## ignore.case选项表示忽略大小写。</span></span>
<span id="cb74-7"><a href="data-management-using-r.html#cb74-7" tabindex="-1"></a><span class="fu">select</span>(iris, <span class="fu">contains</span>(<span class="st">&quot;etal&quot;</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>##     Petal.Length Petal.Width
## 1            1.4         0.2
## 2            1.4         0.2
## 3            1.3         0.2
## 4            1.5         0.2
## 5            1.4         0.2
## 6            1.7         0.4
## 7            1.4         0.3
## 8            1.5         0.2
## 9            1.4         0.2
## 10           1.5         0.1
## 11           1.5         0.2
## 12           1.6         0.2
## 13           1.4         0.1
## 14           1.1         0.1
## 15           1.2         0.2
## 16           1.5         0.4
## 17           1.3         0.4
## 18           1.4         0.3
## 19           1.7         0.3
## 20           1.5         0.3
## 21           1.7         0.2
## 22           1.5         0.4
## 23           1.0         0.2
## 24           1.7         0.5
## 25           1.9         0.2
## 26           1.6         0.2
## 27           1.6         0.4
## 28           1.5         0.2
## 29           1.4         0.2
## 30           1.6         0.2
## 31           1.6         0.2
## 32           1.5         0.4
## 33           1.5         0.1
## 34           1.4         0.2
## 35           1.5         0.2
## 36           1.2         0.2
## 37           1.3         0.2
## 38           1.4         0.1
## 39           1.3         0.2
## 40           1.5         0.2
## 41           1.3         0.3
## 42           1.3         0.3
## 43           1.3         0.2
## 44           1.6         0.6
## 45           1.9         0.4
## 46           1.4         0.3
## 47           1.6         0.2
## 48           1.4         0.2
## 49           1.5         0.2
## 50           1.4         0.2
## 51           4.7         1.4
## 52           4.5         1.5
## 53           4.9         1.5
## 54           4.0         1.3
## 55           4.6         1.5
## 56           4.5         1.3
## 57           4.7         1.6
## 58           3.3         1.0
## 59           4.6         1.3
## 60           3.9         1.4
## 61           3.5         1.0
## 62           4.2         1.5
## 63           4.0         1.0
## 64           4.7         1.4
## 65           3.6         1.3
## 66           4.4         1.4
## 67           4.5         1.5
## 68           4.1         1.0
## 69           4.5         1.5
## 70           3.9         1.1
## 71           4.8         1.8
## 72           4.0         1.3
## 73           4.9         1.5
## 74           4.7         1.2
## 75           4.3         1.3
## 76           4.4         1.4
## 77           4.8         1.4
## 78           5.0         1.7
## 79           4.5         1.5
## 80           3.5         1.0
## 81           3.8         1.1
## 82           3.7         1.0
## 83           3.9         1.2
## 84           5.1         1.6
## 85           4.5         1.5
## 86           4.5         1.6
## 87           4.7         1.5
## 88           4.4         1.3
## 89           4.1         1.3
## 90           4.0         1.3
## 91           4.4         1.2
## 92           4.6         1.4
## 93           4.0         1.2
## 94           3.3         1.0
## 95           4.2         1.3
## 96           4.2         1.2
## 97           4.2         1.3
## 98           4.3         1.3
## 99           3.0         1.1
## 100          4.1         1.3
## 101          6.0         2.5
## 102          5.1         1.9
## 103          5.9         2.1
## 104          5.6         1.8
## 105          5.8         2.2
## 106          6.6         2.1
## 107          4.5         1.7
## 108          6.3         1.8
## 109          5.8         1.8
## 110          6.1         2.5
## 111          5.1         2.0
## 112          5.3         1.9
## 113          5.5         2.1
## 114          5.0         2.0
## 115          5.1         2.4
## 116          5.3         2.3
## 117          5.5         1.8
## 118          6.7         2.2
## 119          6.9         2.3
## 120          5.0         1.5
## 121          5.7         2.3
## 122          4.9         2.0
## 123          6.7         2.0
## 124          4.9         1.8
## 125          5.7         2.1
## 126          6.0         1.8
## 127          4.8         1.8
## 128          4.9         1.8
## 129          5.6         2.1
## 130          5.8         1.6
## 131          6.1         1.9
## 132          6.4         2.0
## 133          5.6         2.2
## 134          5.1         1.5
## 135          5.6         1.4
## 136          6.1         2.3
## 137          5.6         2.4
## 138          5.5         1.8
## 139          4.8         1.8
## 140          5.4         2.1
## 141          5.6         2.4
## 142          5.1         2.3
## 143          5.1         1.9
## 144          5.9         2.3
## 145          5.7         2.5
## 146          5.2         2.3
## 147          5.0         1.9
## 148          5.2         2.0
## 149          5.4         2.3
## 150          5.1         1.8</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="data-management-using-r.html#cb76-1" tabindex="-1"></a>    <span class="do">## 将几个变量移到数据框的开头</span></span>
<span id="cb76-2"><a href="data-management-using-r.html#cb76-2" tabindex="-1"></a><span class="fu">select</span>(flights, time_hour, air_time, <span class="fu">everything</span>())</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 19
##    time_hour           air_time  year month   day dep_time sched_dep_time
##    &lt;dttm&gt;                 &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;
##  1 2013-01-01 05:00:00      227  2013     1     1      517            515
##  2 2013-01-01 05:00:00      227  2013     1     1      533            529
##  3 2013-01-01 05:00:00      160  2013     1     1      542            540
##  4 2013-01-01 05:00:00      183  2013     1     1      544            545
##  5 2013-01-01 06:00:00      116  2013     1     1      554            600
##  6 2013-01-01 05:00:00      150  2013     1     1      554            558
##  7 2013-01-01 06:00:00      158  2013     1     1      555            600
##  8 2013-01-01 06:00:00       53  2013     1     1      557            600
##  9 2013-01-01 06:00:00      140  2013     1     1      557            600
## 10 2013-01-01 06:00:00      138  2013     1     1      558            600
## # ℹ 336,766 more rows
## # ℹ 12 more variables: dep_delay &lt;dbl&gt;, arr_time &lt;int&gt;, sched_arr_time &lt;int&gt;,
## #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
## #   dest &lt;chr&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="data-management-using-r.html#cb78-1" tabindex="-1"></a>    <span class="do">## rename</span></span>
<span id="cb78-2"><a href="data-management-using-r.html#cb78-2" tabindex="-1"></a><span class="fu">rename</span>(flights, <span class="at">tail_num =</span> tailnum)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 336,766 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tail_num &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
<div id="summarise" class="section level3 hasAnchor" number="2.5.10">
<h3><span class="header-section-number">2.5.10</span> summarise<a href="data-management-using-r.html#summarise" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="data-management-using-r.html#cb80-1" tabindex="-1"></a><span class="do">## with group_by</span></span>
<span id="cb80-2"><a href="data-management-using-r.html#cb80-2" tabindex="-1"></a>by_day <span class="ot">&lt;-</span> <span class="fu">group_by</span>(flights, year, month, day)</span>
<span id="cb80-3"><a href="data-management-using-r.html#cb80-3" tabindex="-1"></a><span class="fu">summarise</span>(by_day, <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 365 × 4
## # Groups:   year, month [12]
##     year month   day delay
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1  2013     1     1 11.5 
##  2  2013     1     2 13.9 
##  3  2013     1     3 11.0 
##  4  2013     1     4  8.95
##  5  2013     1     5  5.73
##  6  2013     1     6  7.15
##  7  2013     1     7  5.42
##  8  2013     1     8  2.55
##  9  2013     1     9  2.28
## 10  2013     1    10  2.84
## # ℹ 355 more rows</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="data-management-using-r.html#cb82-1" tabindex="-1"></a><span class="do">## pipe, %&gt;%:</span></span>
<span id="cb82-2"><a href="data-management-using-r.html#cb82-2" tabindex="-1"></a>delays <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="data-management-using-r.html#cb82-3" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb82-4"><a href="data-management-using-r.html#cb82-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb82-5"><a href="data-management-using-r.html#cb82-5" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb82-6"><a href="data-management-using-r.html#cb82-6" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-7"><a href="data-management-using-r.html#cb82-7" tabindex="-1"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-8"><a href="data-management-using-r.html#cb82-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb82-9"><a href="data-management-using-r.html#cb82-9" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">20</span>, dest <span class="sc">!=</span> <span class="st">&quot;HNL&quot;</span>)</span>
<span id="cb82-10"><a href="data-management-using-r.html#cb82-10" tabindex="-1"></a>delays</span></code></pre></div>
<pre><code>## # A tibble: 96 × 4
##    dest  count  dist delay
##    &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 ABQ     254 1826   4.38
##  2 ACK     265  199   4.85
##  3 ALB     439  143  14.4 
##  4 ATL   17215  757. 11.3 
##  5 AUS    2439 1514.  6.02
##  6 AVL     275  584.  8.00
##  7 BDL     443  116   7.05
##  8 BGR     375  378   8.03
##  9 BHM     297  866. 16.9 
## 10 BNA    6333  758. 11.8 
## # ℹ 86 more rows</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="data-management-using-r.html#cb84-1" tabindex="-1"></a><span class="do">## 进行任何汇总时，最好都包含一个计数（n（））或一个非缺失值的计数</span></span>
<span id="cb84-2"><a href="data-management-using-r.html#cb84-2" tabindex="-1"></a><span class="do">## count=n(),</span></span>
<span id="cb84-3"><a href="data-management-using-r.html#cb84-3" tabindex="-1"></a><span class="do">## non_miss=sum(!is.na(arr_delay)),</span></span>
<span id="cb84-4"><a href="data-management-using-r.html#cb84-4" tabindex="-1"></a></span>
<span id="cb84-5"><a href="data-management-using-r.html#cb84-5" tabindex="-1"></a><span class="do">## quo()函数来求多值, “!!!”是引用终值并解析操作符，使用对象为元素为引用的列表或向量，它将引用的表达式解析并计算，每个列表元素都释放为summarize()函数的参数。另有“!!”操作符针对非列表对象</span></span>
<span id="cb84-6"><a href="data-management-using-r.html#cb84-6" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cuckoos&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DAAG&quot;</span>)</span>
<span id="cb84-7"><a href="data-management-using-r.html#cb84-7" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">quo</span>(<span class="fu">mean</span>(length)), <span class="fu">quo</span>(<span class="fu">sd</span>(length)),</span>
<span id="cb84-8"><a href="data-management-using-r.html#cb84-8" tabindex="-1"></a>            <span class="fu">quo</span>(<span class="fu">mean</span>(breadth)), <span class="fu">quo</span>(<span class="fu">sd</span>(breadth)))</span>
<span id="cb84-9"><a href="data-management-using-r.html#cb84-9" tabindex="-1"></a>cuckoos <span class="sc">%&gt;%</span></span>
<span id="cb84-10"><a href="data-management-using-r.html#cb84-10" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb84-11"><a href="data-management-using-r.html#cb84-11" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="sc">!!!</span> var)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   species       `mean(length)` `sd(length)` `mean(breadth)` `sd(breadth)`
##   &lt;fct&gt;                  &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;
## 1 hedge.sparrow           23.1        1.05             16.8         0.534
## 2 meadow.pipit            22.3        0.920            16.7         0.383
## 3 pied.wagtail            22.9        1.07             16.5         0.450
## 4 robin                   22.6        0.682            16.4         0.548
## 5 tree.pipit              23.1        0.880            16.7         0.450
## 6 wren                    21.1        0.754            15.8         0.313</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="data-management-using-r.html#cb86-1" tabindex="-1"></a><span class="do">## Äquivalent</span></span>
<span id="cb86-2"><a href="data-management-using-r.html#cb86-2" tabindex="-1"></a>cuckoos <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="data-management-using-r.html#cb86-3" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="data-management-using-r.html#cb86-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mw_length =</span> <span class="fu">mean</span>(length),</span>
<span id="cb86-5"><a href="data-management-using-r.html#cb86-5" tabindex="-1"></a>            <span class="at">mw_breadth =</span> <span class="fu">mean</span>(breadth)) <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="data-management-using-r.html#cb86-6" tabindex="-1"></a>  <span class="fu">arrange</span>(mw_length, mw_breadth)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   species       mw_length mw_breadth
##   &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt;
## 1 wren               21.1       15.8
## 2 meadow.pipit       22.3       16.7
## 3 robin              22.6       16.4
## 4 pied.wagtail       22.9       16.5
## 5 tree.pipit         23.1       16.7
## 6 hedge.sparrow      23.1       16.8</code></pre>
</div>
</div>
<div id="package-stringr" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Package stringr<a href="data-management-using-r.html#package-stringr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cheat-sheet-2" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> CHEAT SHEET<a href="data-management-using-r.html#cheat-sheet-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:stringr-1"></span>
<img src="02_Plots/stringr_sheet1.png" alt="strings with stringr: CHEAT SHEET" width="100%" />
<p class="caption">
Figure 2.9: strings with stringr: CHEAT SHEET
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:stringr-2"></span>
<img src="02_Plots/stringr_sheet2.png" alt="strings with stringr: CHEAT SHEET" width="100%" />
<p class="caption">
Figure 2.10: strings with stringr: CHEAT SHEET
</p>
</div>
</div>
</div>
<div id="package-forcats" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Package forcats<a href="data-management-using-r.html#package-forcats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cheat-sheet-3" class="section level3 hasAnchor" number="2.7.1">
<h3><span class="header-section-number">2.7.1</span> CHEAT SHEET<a href="data-management-using-r.html#cheat-sheet-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:forcats"></span>
<img src="02_Plots/forcats_sheet1.png" alt="Factors with forcats: CHEAT SHEET" width="100%" />
<p class="caption">
Figure 2.11: Factors with forcats: CHEAT SHEET
</p>
</div>
</div>
</div>
<div id="package-lubridate" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Package lubridate<a href="data-management-using-r.html#package-lubridate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cheat-sheet-4" class="section level3 hasAnchor" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> CHEAT SHEET<a href="data-management-using-r.html#cheat-sheet-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:lubridate-1"></span>
<img src="02_Plots/lubridate_sheet1.png" alt="Dates and times with lubridate: CHEAT SHEET" width="100%" />
<p class="caption">
Figure 2.12: Dates and times with lubridate: CHEAT SHEET
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:lubridate-2"></span>
<img src="02_Plots/lubridate_sheet2.png" alt="Dates and times with lubridate: CHEAT SHEET" width="100%" />
<p class="caption">
Figure 2.13: Dates and times with lubridate: CHEAT SHEET
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-management-using-sas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Zehuibai/Data-Analyst-Tutorial/edit/main/02-Data-Management-using-R.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Zehuibai/Data-Analyst-Tutorial/blob/main/02-Data-Management-using-R.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
